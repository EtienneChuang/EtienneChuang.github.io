<!DOCTYPE html>
<META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
<html>
<head>
	<title>Where To Buy Mask</title>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/fixedheader/3.1.6/js/dataTables.fixedHeader.min.js"></script>
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css">
	<style type="text/css">
		.chart div {
			color : white;
			padding : 0px;
			margin : 2px;
			
			text-align: left;
			background-color: steelblue;
			font: 10px sans-serif;

		}
		#myTable {
			text-align: center;
		}
	</style>
</head>
<body>
	<div class="chart"></div>
	<div align="right">
		<h5>
			於搜尋欄輸入關鍵字可過濾出符合的資料，如電話、縣市、地區
		</h5>
	</div>
	<div>
		<table id="myTable" class="display">
			<thead>
				<tr>
					<th>醫事機構名稱</th>
					<th>醫事機構地址</th>
					<th>醫事機構電話</th>
					<th>成人口罩總剩餘數</th>
					<th>兒童口罩剩餘數</th>
					<th>來源資料時間</th>
				</tr>
			</thead>
			<tbody></tbody>
		</table>
	</div>
</body>
	
<script type="text/javascript">
	let limit = 10;
	window.onload =  function() {
		$.get('json/maskdata.json', function(data) {    
			$('#myTable').DataTable({
               	"data": data,
				"columns": [	
					{ "data": '醫事機構名稱' },
					{ "data": '醫事機構地址' },
					{ "data": '醫事機構電話' },
					{ "data": '成人口罩總剩餘數' },
					{ "data": '兒童口罩剩餘數' },
					{ "data": '來源資料時間' }
				]
			});
			$("#myTable>thead>tr>th").each(function(){
                $(this).css("position", "-webkit-sticky").css("position", "sticky").css("top", 0).css("background-color", "white")
            });
			addLink();
            $("#myTable_length").on("change", function() {
        		addLink();
        	});
        	$("input").on("change", function() {
        		addLink();
        	});
        	$("#myTable>thead>tr").on("click", function() {
        		addLink();
        	});
		});

		function addLink() {
			$("#myTable>tbody>tr").each(function(){
				$(this).find("td").each(function(index, td){
					if(index == 1) {
						var address = $(td).html();
						var link = "<a target='_blank' href='https://www.google.com/maps?q=" 
								+ address + "'>"+address+"</a> ";
                		$(td).html(link);
					}
            	});
			});
		}
	};
</script>
</html>